<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_25) on Wed Feb 12 10:03:33 PST 2014 -->
<title>org.transitime.db.hibernate</title>
<meta name="date" content="2014-02-12">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="org.transitime.db.hibernate";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/transitime/db/package-summary.html">Prev Package</a></li>
<li><a href="../../../../org/transitime/db/structs/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/transitime/db/hibernate/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.transitime.db.hibernate</h1>
<div class="docSummary">
<div class="block">Notes about Hibernate.</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/db/hibernate/AnnotatedClassesList.html" title="class in org.transitime.db.hibernate">AnnotatedClassesList</a></td>
<td class="colLast">
<div class="block">Yes, this is a nuisance.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/transitime/db/hibernate/DataDbLogger.html" title="class in org.transitime.db.hibernate">DataDbLogger</a></td>
<td class="colLast">
<div class="block">DataDbLogger is for storing to the db a stream of data objects.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/db/hibernate/HibernateUtils.html" title="class in org.transitime.db.hibernate">HibernateUtils</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/transitime/db/hibernate/PrecisionTimestampType.html" title="class in org.transitime.db.hibernate">PrecisionTimestampType</a></td>
<td class="colLast">
<div class="block">The purpose of this class was to have a custom hibernate type for a 
 Timestamp column so that could write fractional seconds.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package org.transitime.db.hibernate Description">Package org.transitime.db.hibernate Description</h2>
<div class="block">Notes about Hibernate.
 <p>
 Hibernate was selected as the ORM (Object Relational Mapping) tool because
 it is both very widely used yet very simple. Once one gets the hang of it
 it greatly reduces the amount of code that needs to be written for reading
 and writing objects.
 <p>
 It is intended that annotations be used (as opposed to an xml based schema
 config file) to specify how an object is mapped to the database. This way
 the mapping info is directly in the class definition and one doesn't need
 to deal with a separate file. 
 <p>
 Every object to be persisted needs a unique Id per row. That way Hibernate
 can compare objects for equality and such. This also means that each
 table should have ah primary key, which of course is also expected for any
 table in a relational database. If multiple columns are needed to establish
 a unique id/primary key then can simply annotated multiple columns with @Id.
 It should be noted that can have null values for primary key columns. This
 is unfortunate because null should be considered a valid identifier. So for
 AVLReports can't have block be part of the primary key because sometimes
 it will be null.
 <p>
 The primary key will automatically create an index so that the db can 
 quickly confirm that the object being inserted is unique. So don't
 need to create a separate index on the primary key column to speed up queries
 that would benefit from an index on that column. It already exists. But
 if the primary key is on multiple columns then things are much more 
 complicated. When multiple columns are used for a primary key then
 an index is created but most likely it will simply use a concatenation
 of what is in the two columns. This is adequate for the db to quickly make
 sure that an object is unique before inserting it but it will not be
 adequate for speeding up some queries. For example, for AvlReport the
 primary key is on time and vehicleId. The index can therefore be
 something like time||vehicleId (concatenation). If one does a query for
 reports between a certain time frame the index unfortunately won't help
 since it is really just a string that includes time and vehicleId. Can't
 find rows based on time. So for this case need a separate index to speed
 up such queries.
 <p>
 Storing time is important yet a nuisance when MySQL is used. Previously
 MySQL did not support fractional seconds. But we really do want to store
 msec as part of times. This is especially true for AVL data where need
 to avoid duplicate key problems with respect to a primary key that uses
 a timestamp. Fortunately since MySQL 5.6.4 one can specify fractional
 timestamps (and other time values). See 
 http://dev.mysql.com/doc/refman/5.6/en/fractional-seconds.html for details.
 When specifying timestamp need to specify number of digits past the decimal
 point. The default for MySQL is 0 for backwards compatibility. For other
 databases the default is 6! So best to explicitly specify the precision
 to TIMESTAMP(3) (or perhaps 6) so that fractional seconds will work with
 any database. 
 <p>
 The C3P0 db connection pooler is used because the one that comes with
 Hibernate is not intended for production use. And C3P0 appears to be
 widely used. 
 If you want to get rid of the C3P0 status that is printed, by default, 
 when hibernate starts, you need to recompile C3P0 sources after changing 
 com.mchange.v2.c3p0.Debug.DEBUG to false. This is a public static final field 
 that cannot be changed by configuration files.
 <p>
 With Hibernate 4.0 ran into lots of problems with the documentation, 
 including online, being out of date. For example, the Hibernate @Entity
 tag has been deprecated and one must now use the JPA one by specifying
 the appropriate import. Even the whole way of creating a session has
 changed and will continue to change. This is a nuisance, but bearable.
 <p>
 One other subtle gotcha with Hibernate is that Sessions are not
 threadsafe. Don't pass them between threads!</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>SkiBu Smith</dd></dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/transitime/db/package-summary.html">Prev Package</a></li>
<li><a href="../../../../org/transitime/db/structs/package-summary.html">Next Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/transitime/db/hibernate/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
